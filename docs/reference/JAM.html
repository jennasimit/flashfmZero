<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>JAM (Joint Analysis of Marginal statistics) — JAM • flashfmZero</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="JAM (Joint Analysis of Marginal statistics) — JAM"><meta property="og:description" content="Wrapper for JAM (Joint Analysis of Marginal statistics). See the Vignette."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flashfmZero</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/flashfmZero.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>JAM (Joint Analysis of Marginal statistics)</h1>
    
    <div class="hidden name"><code>JAM.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Wrapper for JAM (Joint Analysis of Marginal statistics). See the Vignette.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">JAM</span><span class="op">(</span></span>
<span>  marginal.betas <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ns.each.ethnicity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  X.ref <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cor.ref <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mafs.ref <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  model.space.priors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta.priors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta.prior.partitions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  g.prior <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tau <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xtx.ridge.term <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  enumerate.up.to.dim <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  full.mcmc.sampling <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n.iter <span class="op">=</span> <span class="fl">1e+06</span>,</span>
<span>  n.mil.iter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  thinning.interval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  extra.arguments <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  initial.model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save.path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  max.model.dim <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  burnin.fraction <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  trait.variance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mrloss.w <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  mrloss.function <span class="op">=</span> <span class="st">"variance"</span>,</span>
<span>  mrloss.marginal.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mrloss.marginal.sy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mafs.if.independent <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  extra.java.arguments <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>marginal.betas</dt>
<dd><p>Vector of (named) marginal effect estimates to re-analyse with JAM under multivariate models.
For multi-ethnic "mJAM" please provide a list of vectors, each element of which is a vector of marginal effects
for a specific ethnicity over the same variants.</p></dd>


<dt>n</dt>
<dd><p>The size of the dataset in which the summary statistics (marginal.betas) were calculated</p></dd>


<dt>ns.each.ethnicity</dt>
<dd><p>For mJAM: A vector of the sizes of each ethnicity dataset in which the summary statistics were calculated.</p></dd>


<dt>X.ref</dt>
<dd><p>Reference genotype matrix used by JAM to impute the SNP-SNP correlations. If multiple regions are to be
analysed this should be a list containing reference genotype matrices for each region. Individual's genotype
must be coded as a numeric risk allele count 0/1/2. Non-integer values reflecting imputation may be given.
NB: The risk allele coding MUST correspond to that used in marginal.betas. These matrices must each be positive definite and
the column names must correspond to the names of the marginal.betas vector.</p></dd>


<dt>cor.ref</dt>
<dd><p>Alternatively to a reference genotype matrix, a reference correlation matrix AND mafs may be supplied to JAM.
NB: The risk allele coding MUST correspond to that used in marginal.betas. These matrices must each be positive definite and
the column and row names must correspond to the names of the marginal.betas vector.</p></dd>


<dt>mafs.ref</dt>
<dd><p>Alternatively to a reference genotype matrix, a reference correlation matrix AND mafs may be supplied to JAM.
NB: The risk allele coding MUST correspond to that used in marginal.betas. This must be a named vector with names correspond
to the names of the marginal.betas vector.</p></dd>


<dt>model.space.priors</dt>
<dd><p>Must be specified if model.selection is set to TRUE.
Two options are available. 1) A fixed prior is placed on the proportion of causal
covariates, and all models with the same number of covariates is equally likely. This
is effectively a Poisson prior over the different possible model sizes. A list must
be supplied for <code>model.space.priors</code> with an element "Rate", specifying the prior
proportion of causal covariates, and an element "Variables" containing the list of covariates
included in the model search. 2) The prior proportion of causal covariates
is treated as unknown and given a Beta(a, b) hyper-prior, in which case
elements "a" and "b" must be included in the <code>model.space.priors</code> list rather
than "Rate". Higher values of "b" relative to "a" will encourage sparsity.
NOTE: It is easy to specify different model space priors for different collections of
covariates by providing a list of lists, each element of which is itself a model.space.prior
list asm described above for a particular subset of the covariates.</p></dd>


<dt>beta.priors</dt>
<dd><p>This allows specifying fixed (potentially informative) priors for the covariate
effect priors. A matrix must be passed, with named rows corresponding to parameters, and columns
corresponding to the prior mean and variance in that order. When using this option priors must
be specified for either just the confounders, which are otherwise given fixed N(0,1e6) priors,
or for all covariates.</p></dd>


<dt>beta.prior.partitions</dt>
<dd><p>Covariate effects under variable selection are ascribed, by default,
a common Normal prior, the standard deviation of which is treated as unknown,
with a Unif(0.05,2) hyper-prior. This option can be used to partition the covariate effects
into different prior groups, each with a seperate hierarchical normal prior. beta.prior.partitions
must be a list with as many elements as desired covariate groups. The element for a particular group
must in turn be a list containing the following named elements: "Variables" - a list of covariates
in the prior group, and "UniformA" and "UniformB" the Uniform hyper parameters for the standard
deviation of the normal prior across their effects.</p></dd>


<dt>g.prior</dt>
<dd><p>Whether to use a g-prior for the beta's, i.e. a multivariate normal
with correlation structure proportional to sigma^2*X'X^-1, which is thought to aid
variable selection in the presence of strong correlation. By default this is enabled.</p></dd>


<dt>tau</dt>
<dd><p>Value to use for sparsity parameter tau (under the tau*sigma^2 parameterisation).
When using the g-prior, a recommended default is max(n, P^2) where n is the number of individuals, and P is the number of predictors.</p></dd>


<dt>xtx.ridge.term</dt>
<dd><p>Value to add to the constant of the diagonal of X'X before JAM takes the Cholesky decomposition.</p></dd>


<dt>enumerate.up.to.dim</dt>
<dd><p>Whether to make posterior inference by exhaustively calculating
the posterior support for every possible model up to this dimension. Leaving at 0 to disable
and use RJMCMC instead. The current maximum allowed value is 5.</p></dd>


<dt>full.mcmc.sampling</dt>
<dd><p>By default JAM only samples models, since the parameters can be analytically integrated out.
If you would like to force JAM to perform full Reversible Jump MCMC of models and parameters (effects and residual), then
set this to TRUE. The posterior summaries can be seen using <code><a href="PrettyResultsTable.html">PrettyResultsTable</a></code>. Note that this option is
forced to false if inference via model enumeration is requested by setting enumerate.up.to.dim&gt;0.</p></dd>


<dt>n.iter</dt>
<dd><p>Number of iterations to run (default is 1e6)</p></dd>


<dt>n.mil.iter</dt>
<dd><p>Number of million iterations to run. Can optionally be used instead of n.iter for convenience, which it will overide if specified.</p></dd>


<dt>thinning.interval</dt>
<dd><p>Every nth iteration to store (i.e. for the Java algorithm to write to a file and then read into R). By default this is the
number of iterations divided by 1e4 (so for 1 million iterations every 100th is stored.) Higher values (so smaller posterior sample) can lead to
faster runtimes for large numbers of covariates.</p></dd>


<dt>seed</dt>
<dd><p>Which random number seed to use in the RJMCMC sampler. If none is provided, a random seed is picked between 1 and 2^16.</p></dd>


<dt>extra.arguments</dt>
<dd><p>A named list of additional arguments for which there are not currently dedicated options for. This can be used to
modify various "under the hood" settings, including all prior hyper-parameters, MCMC mixing parameters such as the probabilities of
add/delete/swap moves as well as the adaption settings. A list of all settings available for modification can be seen by typing
"data(DefaultArguments)" and then "default.arguments", which lists their names and default values.</p></dd>


<dt>initial.model</dt>
<dd><p>An initial model for the covariates under selection can be specified as a vector of 0s and 1s.
If left un-specified the null (empty) model is used.</p></dd>


<dt>save.path</dt>
<dd><p>By default R2BGLiMS writes the posterior samples to a temporary file that is deleted after they have been read in to R. By
specifying a file path this can be kept, along with the temporary files used for the data and arguments, which can be useful sometimes for de-bugging.</p></dd>


<dt>debug</dt>
<dd><p>Whether to output extra information (such as final adaption proposal SDs) which might help with debugging
(default is FALSE).</p></dd>


<dt>max.model.dim</dt>
<dd><p>The maximum model dimension can be specified, therefore truncating the model space. We do not recommend using this option
but it might sometimes be useful for robust-ness checks. When left un-specified there is no restriction on the model size.</p></dd>


<dt>burnin.fraction</dt>
<dd><p>Initial fraction of the iterations to throw away, e.g. setting to 0 would mean no burn-in. The
default of 0.5 corresponds to the first half of iterations being discarded.</p></dd>


<dt>trait.variance</dt>
<dd><p>NB EXPERIMENTAL: Invokes a slightly different summary statistic likelihood, which requires an estimate of
the trait variance to be provided. (Not yet implemented to work with mJAM or enumeration)</p></dd>


<dt>mrloss.w</dt>
<dd><p>The relative weight of the MR log loss function for pleiotropy vs the log likelihood. Default 0.</p></dd>


<dt>mrloss.function</dt>
<dd><p>Choice of pleiotropic loss function from "steve", "variance" (default variance)</p></dd>


<dt>mrloss.marginal.by</dt>
<dd><p>Marginal associations between SNPs and outcome for the MR loss function model.</p></dd>


<dt>mrloss.marginal.sy</dt>
<dd><p>Standard errors of marginal associations between SNPs and outcome for the MR loss function model
(not required for mrloss.function "variance")</p></dd>


<dt>mafs.if.independent</dt>
<dd><p>If the SNPs are independent then a reference genotype matrix is not required.
However, it is still necessary to provide SNP MAFs here as a named vector. Doing so will lead to X.ref being
ignored and the SNPs to be modelled as if they are independent. Note that this option does not work with
enumeration.</p></dd>


<dt>extra.java.arguments</dt>
<dd><p>A character string to be passed through to the java command line. E.g. to specify a
different temporary directory by passing "-Djava.io.tmpdir=/Temp".</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An R2BGLiMS_Results class object is returned. See the slot 'posterior.summary.table' for a posterior summary of all parameters.
See slot 'mcmc.output' for a matrix containing the raw MCMC output from the saved posterior samples (0 indicates a covariate is excluded
from the model in a particular sample. Some functions for summarising results are listed under "see also".</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Summary results are stored in the slot posterior.summary.table. See <code><a href="ManhattanPlot.html">ManhattanPlot</a></code> for a visual
summary of covariate selection probabilities. For posterior model space summaries see <code><a href="TopModels.html">TopModels</a></code>. For
convergence checks see <code><a href="AutocorrelationPlot.html">AutocorrelationPlot</a></code>.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Paul Newcombe</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jenn Asimit, Feng Zhou.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

